<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>CTF-1</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="Webflow" name="generator" />
    <link
      rel="icon"
      type="image/png"
      href="https://cdn-icons-png.flaticon.com/128/1999/1999625.png"
    />
    <link
      href="https://cdn.prod.website-files.com/67c1f03b51e9dac31ca162e7/css/publics-dynamite-site.webflow.63912b962.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <style>
      html {
        font-size: 62.5%;
      }
    </style>
    <link rel="stylesheet" href="/assets/style.css" />
  </head>
  <body>
    <div
      data-collapse="medium"
      data-animation="default"
      data-duration="400"
      data-easing="ease"
      data-easing2="ease"
      role="banner"
      class="header w-nav"
    >
      <a
        href="/"
        aria-current="page"
        class="logo-wrapper w-nav-brand w--current"
        ><img
          src="https://cdn-icons-png.flaticon.com/128/1999/1999625.png"
          alt="Logo"
          class="logo"
      /></a>
    </div>
    <div class="site-container">
      <div class="section small-section">
        <div class="container">
          <h1>CTF-1</h1>
          <div class="subhead">"Find the location!"</div>
        </div>
      </div>
      <div
        data-w-id="17ac18b5-161b-07f2-842a-a33f4d0523b9"
        class="section list-writeup pattern"
      >
        <div class="container">
          <div
            data-w-id="17ac18b5-161b-07f2-842a-a33f4d0523d8"
            role="listitem"
            class="modal-wrapper w-dyn-item"
          >
            <div class="modal-header">
              <div class="button-circles-wrap">
                <div class="button-circle"></div>
                <div class="button-circle"></div>
              </div>
              <div class="flex-center">
                <div>Easy</div>
              </div>
            </div>
            <div
              style="
                background-image: url(&quot;/challenge/ctf-x099123hR88.png&quot;);
              "
              class="modal-thumbnail"
            ></div>
            <div style="padding: 32px; padding-bottom: 0px">
              <small style="color: orange"
                ><i class="bi bi-lightbulb-fill"></i> Clue:</small
              >
              <ul class="clue-list">
                <li><small>Deep image analysis</small></li>
                <li><small>Basic decode technique</small></li>
                <li>
                  <small
                    >Find a google maps link start with
                    https://www.google.com/maps/@-7.88......</small
                  >
                </li>
              </ul>
            </div>
            <div class="modal-body" style="padding-bottom: 20px">
              <div class="row-space-between">
                <div class="input-group mb-3">
                  <input
                    id="ctf-ans"
                    type="text"
                    class="form-control input-custom"
                    placeholder="@-latitude,longitude"
                    autocomplete="off"
                  />
                  <button
                    class="button read-writeup submit-ctf w-button"
                    type="button"
                    id="button-addon2"
                  >
                    Check
                  </button>
                </div>
              </div>
            </div>
            <div style="padding: 32px; padding-top: 0px" id="result-ans"></div>
          </div>
        </div>
      </div>
      <div class="footer-custom">Â© All ctf created by Rona.</div>
    </div>
    <script
      src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"
      type="text/javascript"
    ></script>
    <script src="/assets/script.js"></script>
    <script>
      const WEBAPP_URL =
        "https://script.google.com/macros/s/AKfycbzNzjDe3I0m8qwBxr692vEWvhpBy8UwOPmj_8pptgs0dP5ap5OsRkPD-XzaSxUPowA2Bw/exec";
      const LEVEL = "ctf-1";
      const input = document.getElementById("ctf-ans");
      const btn = document.getElementById("button-addon2");
      const out = document.getElementById("result-ans");

      function jsonp(url, params, timeoutMs = 10000) {
        return new Promise((resolve, reject) => {
          const cb =
            "cb_" + Date.now() + "_" + Math.random().toString(16).slice(2);
          params.callback = cb;

          const qs = new URLSearchParams(params).toString();
          const src = url + (url.includes("?") ? "&" : "?") + qs;

          const script = document.createElement("script");
          let timer = null;

          function cleanup() {
            if (timer) clearTimeout(timer);
            delete window[cb];
            script.remove();
          }

          window[cb] = (data) => {
            cleanup();
            resolve(data);
          };

          script.onerror = () => {
            cleanup();
            reject(new Error("Request failed (script load error)"));
          };

          timer = setTimeout(() => {
            cleanup();
            reject(new Error("Request timeout"));
          }, timeoutMs);

          script.src = src;
          document.body.appendChild(script);
        });
      }

      async function checkAnswer() {
        const ans = input.value;
        out.textContent = "Checking...";
        btn.disabled = true;
        try {
          const data = await jsonp(WEBAPP_URL, { level: LEVEL, ans });
          out.textContent = JSON.stringify(data, null, 2);
          if (data && data.ok === true) {
            out.innerHTML = `
            <small style="color: green"
                ><i class="bi bi-patch-check-fill"></i> Correct! Reward for you: ${data.reward}
              </small>`;
          } else {
            out.innerHTML = `
            <small style="color: red"
                ><i class="bi bi-exclamation-triangle-fill"></i> Incorret! Try again..
              </small>
            `;
          }
        } catch (err) {
          out.innerHTML = `
            <small style="color: red"
                ><i class="bi bi-exclamation-triangle-fill"></i> ${err.message}
              </small>
            `;
        } finally {
          btn.disabled = false;
        }
      }
      btn.addEventListener("click", checkAnswer);
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") checkAnswer();
      });
    </script>
  </body>
</html>
